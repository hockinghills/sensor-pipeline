[global_tags]

[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "2s"
  flush_interval = "10s"
  flush_jitter = "2s"
  precision = ""
  hostname = "piiot"
  omit_hostname = false

[[outputs.influxdb_v2]]
  urls = ["http://127.0.0.1:8086"]
  token = "oxofnG-llFqgr8S5ZddcnI8DdqdbCkFn-2-svlyjD2YjKptM6tpvSDwv0VxNlyj1LhbH7Us1Tv_BEEmhCOxshQ=="
  organization = "empyrean"
  bucket = "fucked"

[[inputs.mqtt_consumer]]
  servers = ["tcp://127.0.0.1:1883"]
  topics = [
    "furnace/data"
  ]
  data_format = "json"
  name_override = "furnace"
  interval = "100ms"  # High-frequency as specified; monitor for performance

[[inputs.multifile]]
  base_dir = "/sys/bus/i2c/devices/1-0077/iio:device0"
  name_override = "multifile"
  interval = "1000ms"

  [[inputs.multifile.file]]
    file = "in_temp_input"
    dest = "temperature"
    conversion = "float"  # Assuming temp in millidegrees; adjust if needed

  [[inputs.multifile.file]]
    file = "in_pressure_input"
    dest = "pressure"
    conversion = "float(3)"  # Assuming hPa * 1000 or similar

  [[inputs.multifile.file]]
    file = "in_humidityrelative_input"
    dest = "humidity"
    conversion = "float"  # Assuming % * 1000

#[[inputs.multifile]]
#  base_dir = "/sys/bus/i2c/devices/1-0048/iio:device0"
#  name_override = "o2_sensor"
#  interval = "100ms"
#
#  [[inputs.multifile.file]]
#    file = "in_voltage1_raw"
#    dest = "voltage_raw"
#    conversion = "float"
#
#  [[inputs.multifile.file]]
#    file = "in_voltage1_scale"
#    dest = "voltage_scale"
#    conversion = "float"
